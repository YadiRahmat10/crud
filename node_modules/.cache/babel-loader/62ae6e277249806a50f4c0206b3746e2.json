{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nexport default function useFetch(url) {\n  _s();\n\n  let {\n    method,\n    headers,\n    body\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const [data, setData] = useState();\n  const [errorStatus, setErrorStatus] = useState();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  function request() {\n    fetch(url, {\n      method: method,\n      headers: headers,\n      body: body\n    }).then(response => {\n      if (response.status === 401) {\n        navigate('/login', {\n          state: {\n            previousUrl: location.pathname\n          }\n        });\n      }\n\n      if (!response.ok) {\n        throw response.status;\n      }\n\n      return response.json();\n    }).then(data => {\n      setData(data);\n    }).catch(e => {\n      setErrorStatus(e);\n    });\n  }\n\n  function appendData(newData) {\n    fetch(url, {\n      method: 'POST',\n      headers: headers,\n      body: JSON.stringify(newData)\n    }).then(response => {\n      if (response.status === 401) {\n        navigate('/login', {\n          state: {\n            previousUrl: location.pathname\n          }\n        });\n      }\n\n      if (!response.ok) {\n        throw response.status;\n      }\n\n      return response.json();\n    }).then(d => {\n      const submitted = Object.values(d)[0];\n      const newState = { ...data\n      };\n      Object.values(newState)[0].push(submitted);\n      setData(newState); //new object, it's seen as a state change\n    }).catch(e => {\n      console.log(e);\n      setErrorStatus(e);\n    });\n  }\n\n  return {\n    request,\n    appendData,\n    data,\n    errorStatus\n  };\n}\n\n_s(useFetch, \"tZKHJ1AZ1dBPliIRb0FmnNaibC4=\", false, function () {\n  return [useNavigate, useLocation];\n});","map":{"version":3,"names":["useState","useEffect","useNavigate","useLocation","useFetch","url","method","headers","body","data","setData","errorStatus","setErrorStatus","navigate","location","request","fetch","then","response","status","state","previousUrl","pathname","ok","json","catch","e","appendData","newData","JSON","stringify","d","submitted","Object","values","newState","push","console","log"],"sources":["D:/reactjs/react/src/hooks/UseFetch.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\n\r\nexport default function useFetch(url, { method, headers, body } = {}) {\r\n    const [data, setData] = useState();\r\n    const [errorStatus, setErrorStatus] = useState();\r\n\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    function request() {\r\n        fetch(url, {\r\n            method: method,\r\n            headers: headers,\r\n            body: body,\r\n        })\r\n            .then((response) => {\r\n                if (response.status === 401) {\r\n                    navigate('/login', {\r\n                        state: {\r\n                            previousUrl: location.pathname,\r\n                        },\r\n                    });\r\n                }\r\n                if (!response.ok) {\r\n                    throw response.status;\r\n                }\r\n                return response.json();\r\n            })\r\n            .then((data) => {\r\n                setData(data);\r\n            })\r\n            .catch((e) => {\r\n                setErrorStatus(e);\r\n            });\r\n    }\r\n\r\n    function appendData(newData) {\r\n        fetch(url, {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify(newData),\r\n        })\r\n            .then((response) => {\r\n                if (response.status === 401) {\r\n                    navigate('/login', {\r\n                        state: {\r\n                            previousUrl: location.pathname,\r\n                        },\r\n                    });\r\n                }\r\n\r\n                if (!response.ok) {\r\n                    throw response.status;\r\n                }\r\n\r\n                return response.json();\r\n            })\r\n            .then((d) => {\r\n                const submitted = Object.values(d)[0];\r\n\r\n                const newState = { ...data };\r\n                Object.values(newState)[0].push(submitted);\r\n\r\n                setData(newState); //new object, it's seen as a state change\r\n            })\r\n            .catch((e) => {\r\n                console.log(e);\r\n                setErrorStatus(e);\r\n            });\r\n    }\r\n\r\n    return { request, appendData, data, errorStatus };\r\n}\r\n"],"mappings":";;AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,kBAAzC;AAEA,eAAe,SAASC,QAAT,CAAkBC,GAAlB,EAAuD;EAAA;;EAAA,IAAhC;IAAEC,MAAF;IAAUC,OAAV;IAAmBC;EAAnB,CAAgC,uEAAJ,EAAI;EAClE,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBV,QAAQ,EAAhC;EACA,MAAM,CAACW,WAAD,EAAcC,cAAd,IAAgCZ,QAAQ,EAA9C;EAEA,MAAMa,QAAQ,GAAGX,WAAW,EAA5B;EACA,MAAMY,QAAQ,GAAGX,WAAW,EAA5B;;EACA,SAASY,OAAT,GAAmB;IACfC,KAAK,CAACX,GAAD,EAAM;MACPC,MAAM,EAAEA,MADD;MAEPC,OAAO,EAAEA,OAFF;MAGPC,IAAI,EAAEA;IAHC,CAAN,CAAL,CAKKS,IALL,CAKWC,QAAD,IAAc;MAChB,IAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;QACzBN,QAAQ,CAAC,QAAD,EAAW;UACfO,KAAK,EAAE;YACHC,WAAW,EAAEP,QAAQ,CAACQ;UADnB;QADQ,CAAX,CAAR;MAKH;;MACD,IAAI,CAACJ,QAAQ,CAACK,EAAd,EAAkB;QACd,MAAML,QAAQ,CAACC,MAAf;MACH;;MACD,OAAOD,QAAQ,CAACM,IAAT,EAAP;IACH,CAjBL,EAkBKP,IAlBL,CAkBWR,IAAD,IAAU;MACZC,OAAO,CAACD,IAAD,CAAP;IACH,CApBL,EAqBKgB,KArBL,CAqBYC,CAAD,IAAO;MACVd,cAAc,CAACc,CAAD,CAAd;IACH,CAvBL;EAwBH;;EAED,SAASC,UAAT,CAAoBC,OAApB,EAA6B;IACzBZ,KAAK,CAACX,GAAD,EAAM;MACPC,MAAM,EAAE,MADD;MAEPC,OAAO,EAAEA,OAFF;MAGPC,IAAI,EAAEqB,IAAI,CAACC,SAAL,CAAeF,OAAf;IAHC,CAAN,CAAL,CAKKX,IALL,CAKWC,QAAD,IAAc;MAChB,IAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;QACzBN,QAAQ,CAAC,QAAD,EAAW;UACfO,KAAK,EAAE;YACHC,WAAW,EAAEP,QAAQ,CAACQ;UADnB;QADQ,CAAX,CAAR;MAKH;;MAED,IAAI,CAACJ,QAAQ,CAACK,EAAd,EAAkB;QACd,MAAML,QAAQ,CAACC,MAAf;MACH;;MAED,OAAOD,QAAQ,CAACM,IAAT,EAAP;IACH,CAnBL,EAoBKP,IApBL,CAoBWc,CAAD,IAAO;MACT,MAAMC,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAcH,CAAd,EAAiB,CAAjB,CAAlB;MAEA,MAAMI,QAAQ,GAAG,EAAE,GAAG1B;MAAL,CAAjB;MACAwB,MAAM,CAACC,MAAP,CAAcC,QAAd,EAAwB,CAAxB,EAA2BC,IAA3B,CAAgCJ,SAAhC;MAEAtB,OAAO,CAACyB,QAAD,CAAP,CANS,CAMU;IACtB,CA3BL,EA4BKV,KA5BL,CA4BYC,CAAD,IAAO;MACVW,OAAO,CAACC,GAAR,CAAYZ,CAAZ;MACAd,cAAc,CAACc,CAAD,CAAd;IACH,CA/BL;EAgCH;;EAED,OAAO;IAAEX,OAAF;IAAWY,UAAX;IAAuBlB,IAAvB;IAA6BE;EAA7B,CAAP;AACH;;GArEuBP,Q;UAIHF,W,EACAC,W"},"metadata":{},"sourceType":"module"}